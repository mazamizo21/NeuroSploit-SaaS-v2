id: defense_evasion
name: Defense Evasion & Cleanup
category: defense_evasion
phase: POST_EXPLOIT
priority: 45
target_types:
  - lab
  - external
description: Evade detection, manipulate logs, obfuscate payloads, clean artifacts, and bypass security controls.
mitre_techniques:
  - T1070       # Indicator Removal
  - T1070.001   # Clear Windows Event Logs
  - T1070.002   # Clear Linux/Mac System Logs
  - T1070.003   # Clear Command History
  - T1070.004   # File Deletion
  - T1070.006   # Timestomp
  - T1070.009   # Clear Persistence
  - T1562       # Impair Defenses
  - T1562.001   # Disable or Modify Tools
  - T1562.002   # Disable Windows Event Logging
  - T1055       # Process Injection
  - T1055.001   # DLL Injection
  - T1055.012   # Process Hollowing
  - T1027       # Obfuscated Files or Information
  - T1027.002   # Software Packing
  - T1027.010   # Command Obfuscation
  - T1140       # Deobfuscate/Decode Files
  - T1036       # Masquerading
  - T1036.001   # Invalid Code Signature
  - T1036.002   # Right-to-Left Override
  - T1036.003   # Rename System Utilities
  - T1036.004   # Masquerade Task or Service
  - T1036.005   # Match Legitimate Name or Location
  - T1036.007   # Double File Extension
  - T1036.009   # Break Process Tree
  - T1564       # Hide Artifacts
  - T1564.001   # Hidden Files and Directories
  - T1564.010   # Process Argument Spoofing
  - T1218       # System Binary Proxy Execution
  - T1218.005   # Mshta
  - T1218.010   # Regsvr32
  - T1218.011   # Rundll32
  - T1572       # Protocol Tunneling
  - T1071       # Application Layer Protocol
  - T1573       # Encrypted Channel
  - T1497       # Virtualization/Sandbox Evasion
  - T1497.001   # System Checks
  - T1497.002   # User Activity Based Checks
  - T1497.003   # Time Based Evasion
  - T1622       # Debugger Evasion
  - T1202       # Indirect Command Execution
  - T1220       # XSL Script Processing
  - T1480       # Execution Guardrails
  - T1006       # Direct Volume Access
  - T1548       # Abuse Elevation Control Mechanism
  - T1548.001   # Setuid and Setgid
  - T1548.002   # Bypass User Account Control
  - T1548.003   # Sudo and Sudo Caching
  - T1134       # Access Token Manipulation
  - T1134.001   # Token Impersonation/Theft
  - T1134.002   # Create Process with Token
  - T1134.004   # Parent PID Spoofing
  - T1134.005   # SID-History Injection
  - T1550       # Use Alternate Authentication Material
  - T1550.002   # Pass the Hash
  - T1550.003   # Pass the Ticket
  - T1550.004   # Web Session Cookie
  - T1222       # File and Directory Permissions Modification
  - T1556       # Modify Authentication Process
  - T1556.001   # Domain Controller Authentication
  - T1556.002   # Password Filter DLL
  - T1556.003   # Pluggable Authentication Modules
  - T1556.004   # Network Device Authentication
  - T1553       # Subvert Trust Controls
  - T1553.001   # Gatekeeper Bypass
  - T1553.002   # Code Signing
  - T1553.003   # SIP and Trust Provider Hijacking
  - T1553.004   # Install Root Certificate
  - T1553.005   # Mark-of-the-Web Bypass
  - T1205       # Traffic Signaling
  - T1205.001   # Port Knocking
  - T1205.002   # Socket Filters
  - T1484       # Domain or Tenant Policy Modification
  - T1484.001   # Group Policy Modification
  - T1484.002   # Domain Trust Modification
inputs:
  - access.json
outputs:
  - defense_evasion.json
  - cleanup_log.json
  - defense_controls.json
  - evasion_techniques.json
  - indicators_cleared.json
  - evidence.json
  - findings.json
prerequisites:
  - access
evidence_collection:
  - Evasion technique results
  - Log manipulation evidence
  - Cleanup verification logs
  - Defense control bypass documentation
success_criteria:
  - Actions performed without triggering alerts
  - All artifacts cleaned and verified
  - Cleanup log complete with reversal steps
safety_notes:
  - Never brick the target system
  - Maintain cleanup log of every change
  - Selective log editing over full wipe
tags:
  - evasion
  - cleanup
  - stealth
  - anti-forensics
  - log-manipulation
