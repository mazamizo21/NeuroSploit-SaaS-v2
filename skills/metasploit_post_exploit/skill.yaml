id: metasploit_post_exploit
name: Metasploit Post-Exploitation
category: credential_access
phase: POST_EXPLOIT
priority: 90
target_types:
  - lab
  - external
description: >
  Complete Metasploit/Meterpreter post-exploitation workflow covering shell upgrade,
  system enumeration, credential harvesting (hashdump, mimikatz, token theft),
  privilege escalation (getsystem, local exploit suggester), pivoting (autoroute,
  portfwd, socks proxy), lateral movement (psexec, wmi, ssh), and persistence
  (registry, scheduled tasks, services). Teaches the full post-exploit kill chain
  from initial shell to domain compromise via msfconsole.
mitre_techniques:
  # OS Credential Dumping
  - T1003
  - T1003.001    # LSASS Memory (mimikatz via meterpreter)
  - T1003.002    # SAM (hashdump)
  - T1003.003    # NTDS
  - T1003.004    # LSA Secrets
  - T1003.006    # DCSync
  # Access Token Manipulation
  - T1134
  - T1134.001    # Token Impersonation/Theft
  - T1134.002    # Create Process with Token
  - T1134.003    # Make and Impersonate Token
  # Exploitation for Privilege Escalation
  - T1068
  # Abuse Elevation Control Mechanism
  - T1548
  - T1548.002    # Bypass UAC
  # Protocol Tunneling / Proxy
  - T1572
  - T1090
  - T1090.001    # Internal Proxy
  # Remote Services
  - T1021
  - T1021.002    # SMB/Windows Admin Shares (PsExec)
  - T1021.003    # DCOM
  - T1021.006    # WinRM
  # Scheduled Task/Job
  - T1053
  - T1053.005    # Scheduled Task
  # Boot or Logon Autostart Execution
  - T1547
  - T1547.001    # Registry Run Keys
  # Create or Modify System Process
  - T1543
  - T1543.003    # Windows Service
  # Process Injection
  - T1055
  # Valid Accounts
  - T1078
  # Lateral Tool Transfer
  - T1570
tools:
  - msfconsole
  - msfvenom
  - meterpreter
inputs:
  - access.json
  - evidence.json
outputs:
  - creds.json
  - priv_esc.json
  - lateral.json
  - persistence.json
  - evidence.json
  - findings.json
prerequisites:
  - access
evidence_collection:
  - Meterpreter session info (sysinfo, getuid)
  - Hashdump output (SAM hashes)
  - Mimikatz/kiwi credential dumps
  - Token impersonation results
  - Pivot route and port forward configurations
  - Lateral movement session confirmations
  - Persistence mechanism deployment proof
success_criteria:
  - Meterpreter session established and upgraded
  - System enumeration completed (sysinfo, getuid, ipconfig)
  - Credentials harvested (hashes or cleartext)
  - Privilege escalation attempted (getsystem or local exploit suggester)
  - Pivoting configured if multi-subnet targets exist
  - Lateral movement executed with harvested credentials
  - Persistence deployed if authorized
safety_notes:
  - All actions require explicit scope authorization
  - Persistence requires ALLOW_PERSISTENCE=true
  - Kernel/memory exploits require explicit approval (crash risk)
  - Always document changes for cleanup
  - Avoid credential dumping on production DCs without explicit approval
tags:
  - metasploit
  - meterpreter
  - post-exploitation
  - credential-harvesting
  - pivoting
  - lateral-movement
  - persistence
  - privilege-escalation
