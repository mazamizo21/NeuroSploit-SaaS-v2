# TazoSploit Pentest Phases

This document defines every phase the system should support so implementation can be complete and consistent. It covers the current API phases and the extended sub‑phases that map to skills and routing.

All phases apply only to explicitly authorized targets within the approved scope. External targets must follow stricter defaults.

## Execution Profiles

1. `lab` profile: full kill chain allowed by default.
2. `external` profile: `RECON` and `VULN_SCAN` allowed by default. `EXPLOIT`, `POST_EXPLOIT`, `LATERAL`, and `FULL` require explicit authorization per scope and phase.

## Core API Phases (Current `job.phase`)

| Phase | Goal | Inputs | Outputs | External Default |
| --- | --- | --- | --- | --- |
| `RECON` | Discover hosts, ports, services, and surface area | Scope targets, exclusions, policies | `ports.json`, `services.json`, `tech_fingerprint.json` | Allowed |
| `VULN_SCAN` | Identify likely vulnerabilities and misconfigurations | Recon artifacts, policies | `vulns.json`, `findings.json` | Allowed |
| `EXPLOIT` | Validate exploitation paths safely and minimally | Vuln artifacts, explicit approvals | `access.json`, `evidence.json`, `findings.json` | Blocked by default |
| `POST_EXPLOIT` | Assess depth of access and risk after entry | Access artifacts, approvals | `creds.json`, `priv_esc.json`, `lateral.json`, `persistence.json` | Blocked by default |
| `LATERAL` | Focused lateral movement and privilege escalation validation | Access artifacts, approvals | `lateral.json`, `priv_esc.json`, `evidence.json` | Blocked by default |
| `FULL` | End-to-end autonomous assessment (recon → report) | Scope targets, approvals, policies | All artifacts | Blocked by default |
| `REPORT` | Summarize risk, evidence, and remediation | All prior artifacts | `report.md`, `report.json` | Allowed |

## Extended Sub‑Phases (Skill Routing Targets)

These are **skills-level phases** used by the router. They can be mapped to `POST_EXPLOIT` or `EXPLOIT` at the API level as needed.

1. **Enumeration & Fingerprinting**  
   Objective: enrich recon data with precise service versions, tech stacks, and exposed endpoints.  
   Outputs: `services.json`, `tech_fingerprint.json`, `endpoints.json`.

2. **Credential Access**  
   Objective: identify and validate credentials in authorized scope.  
   Outputs: `creds.json`, `evidence.json`.

3. **Privilege Escalation**  
   Objective: determine if higher privileges are attainable on an accessed system.  
   Outputs: `priv_esc.json`, `evidence.json`.

4. **Lateral Movement**  
   Objective: test movement within the scoped environment after access is gained.  
   Outputs: `lateral.json`, `evidence.json`.  
   Note: this also maps to the `LATERAL` core phase when a focused lateral-only run is required.

5. **Persistence**  
   Objective: verify persistence risks in a controlled manner.  
   Outputs: `persistence.json`, `evidence.json`.

6. **Defense Evasion / Cleanup**  
   Objective: assess evasion risk without destructive actions.  
   Outputs: `defense_evasion.json`, `evidence.json`.

7. **Data Access Validation**  
   Objective: validate data exposure with minimal collection.  
   Outputs: `data_access.json`, `evidence.json`.

## Artifact Contract (Required Outputs)

Every phase should emit structured artifacts to enable deterministic routing and reporting:

1. `ports.json` and `services.json` for discovery.
2. `tech_fingerprint.json` and `endpoints.json` for web enumeration.
3. `vulns.json` and `findings.json` for vulnerability identification.
4. `access.json` and `evidence.json` when exploitation succeeds.
5. `creds.json`, `priv_esc.json`, `lateral.json`, `persistence.json` for post‑exploit validation.
6. `report.md` and `report.json` for final output.

## Skill Mapping (Categories to Phases)

These skill categories align with the phases above and should be implemented for full coverage:

1. `reconnaissance` → `RECON`, Enumeration & Fingerprinting  
2. `scanning` → `VULN_SCAN`  
3. `exploitation` → `EXPLOIT`  
4. `credential_access` → Credential Access  
5. `privilege_escalation` → Privilege Escalation  
6. `lateral_movement` → Lateral Movement  
7. `persistence` → Persistence  
8. `defense_evasion` → Defense Evasion / Cleanup  
9. `exfiltration` → Data Access Validation  
10. `reporting` → `REPORT`

## Safety and Scope Rules

1. Only act on targets explicitly listed in scope.  
2. No subnet scans unless the scope explicitly authorizes a CIDR.  
3. External targets require explicit authorization for `EXPLOIT`, `POST_EXPLOIT`, `LATERAL`, and `FULL`.  
4. All actions should generate evidence artifacts for audit.

## Implementation Notes

1. The API can continue to use the current phase enum while the router maps skills to these sub‑phases.  
2. For external mode, the router must refuse to schedule exploit or post‑exploit skills without explicit approval.  
3. Every skill should declare its phase, required inputs, and outputs so the router can enforce dependencies.
